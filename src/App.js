import React, { Component } from 'react';
import axios from 'axios'
import './App.css';
import Layout from './components/Layout/Layout'
import PosterGrid from './components/PosterGrid/PosterGrid'

/*
* https://api.themoviedb.org/3/movie/550?api_key=5d1c10a50fcbc080eb1e67449233dfc2
*
* http://image.tmdb.org/t/p/w185//<poster_path>
*/

const TMDB_API_KEY = '5d1c10a50fcbc080eb1e67449233dfc2';

const movies_path = '/movies/popular';

class App extends Component {
  state = {
    apiKey: TMDB_API_KEY,
    movies: [],
    connected: false
  }

  componentDidMount = () => {
      this.updateMovieList();
  }

  movieSelectedHandler = (movie_id) => {
      // called when a poster is clicked on
      const movie = this.state.movies.find((movie) => movie.id == movie_id);
      alert(movie.original_title);
  }

  updateMovieList = () => {
      // query the list of movies and use it to update the state
      /*axios.get(movies_path, {params: {api_key: this.state.apiKey}})
        .then((response) => {
          const newMovies = response.results.map((
            {original_title, poster_path, overview, release_date, id, backdrop_path, vote_average}) 
            => {original_title, poster_path, overview, release_date, id, backdrop_path, vote_average});
          this.setState({movies: newMovies, connected: true});
        }).catch((error) => {
          this.setState({connected: false});
        });*/
      // TODO - implement axios
      const response = {"page":1,"total_results":19833,"total_pages":992,"results":[{"vote_count":7700,"id":299536,"video":false,"vote_average":8.3,"title":"Avengers: Infinity War","popularity":234.221,"poster_path":"\/7WsyChQLEftFiDOVTGkv3hFpyyt.jpg","original_language":"en","original_title":"Avengers: Infinity War","genre_ids":[12,878,14,28],"backdrop_path":"\/bOGkgRGdhrBYJSLpXaxhXVstddV.jpg","adult":false,"overview":"As the Avengers and their allies have continued to protect the world from threats too large for any one hero to handle, a new danger has emerged from the cosmic shadows: Thanos. A despot of intergalactic infamy, his goal is to collect all six Infinity Stones, artifacts of unimaginable power, and use them to inflict his twisted will on all of reality. Everything the Avengers have fought for has led up to this moment - the fate of Earth and existence itself has never been more uncertain.","release_date":"2018-04-25"},{"vote_count":4622,"id":383498,"video":false,"vote_average":7.5,"title":"Deadpool 2","popularity":143.215,"poster_path":"\/to0spRl1CMDvyUbOnbb4fTk3VAd.jpg","original_language":"en","original_title":"Deadpool 2","genre_ids":[28,35,878],"backdrop_path":"\/3P52oz9HPQWxcwHOwxtyrVV1LKi.jpg","adult":false,"overview":"Wisecracking mercenary Deadpool battles the evil and powerful Cable and other bad guys to save a boy's life.","release_date":"2018-05-15"},{"vote_count":3015,"id":351286,"video":false,"vote_average":6.5,"title":"Jurassic World: Fallen Kingdom","popularity":142.026,"poster_path":"\/c9XxwwhPHdaImA2f1WEfEsbhaFB.jpg","original_language":"en","original_title":"Jurassic World: Fallen Kingdom","genre_ids":[28,12,878],"backdrop_path":"\/3s9O5af2xWKWR5JzP2iJZpZeQQg.jpg","adult":false,"overview":"Three years after the demise of Jurassic World, a volcanic eruption threatens the remaining dinosaurs on the isla Nublar, so Claire Dearing, the former park manager, recruits Owen Grady to help prevent the extinction of the dinosaurs once again.","release_date":"2018-06-06"},{"vote_count":723,"id":345940,"video":false,"vote_average":6.2,"title":"The Meg","popularity":127.544,"poster_path":"\/xqECHNvzbDL5I3iiOVUkVPJMSbc.jpg","original_language":"en","original_title":"The Meg","genre_ids":[28,878,53,27],"backdrop_path":"\/rH79sB6Nkx4cMW3JzsUy7wK0rhX.jpg","adult":false,"overview":"A deep sea submersible pilot revisits his past fears in the Mariana Trench, and accidentally unleashes the seventy foot ancestor of the Great White Shark believed to be extinct.","release_date":"2018-08-09"},{"vote_count":1429,"id":402900,"video":false,"vote_average":7,"title":"Ocean's Eight","popularity":111.694,"poster_path":"\/MvYpKlpFukTivnlBhizGbkAe3v.jpg","original_language":"en","original_title":"Ocean's Eight","genre_ids":[80,35,28,53],"backdrop_path":"\/scQf03Fm3jeyv4FH04qvi4fp4wh.jpg","adult":false,"overview":"Debbie Ocean, a criminal mastermind, gathers a crew of female thieves to pull off the heist of the century at New York's annual Met Gala.","release_date":"2018-06-07"},{"vote_count":12,"id":135870,"video":false,"vote_average":5.3,"title":"Rebel","popularity":103.199,"poster_path":"\/dNTzorrVmcJ25fUGzs9FfkoXb0P.jpg","original_language":"te","original_title":"రెబెల్","genre_ids":[28],"backdrop_path":"\/yCGEkEqy7uOo7NwlbgOzGrI8i43.jpg","adult":false,"overview":"Rebel is a romantic action revenge drama, which revolves around the story of a happy-go-lucky guy. The hero (Prabhas) is the son of a good-natured mafia don (Krishnam Raju). The hero becomes Rebel after his father is killed. How he takes revenge upon the people, who killed his father, will form the second half of the movie. Apart from directing, Raghava Lawrence also handles the choreography, screenplay and music direction for the film. The film is being produced by J. Bhaghawan and J. Pulla Rao under Sri Balaji Cine Media banner.","release_date":"2012-09-28"},{"vote_count":1353,"id":353081,"video":false,"vote_average":7.4,"title":"Mission: Impossible - Fallout","popularity":96.404,"poster_path":"\/AkJQpZp9WoNdj7pLYSj1L0RcMMN.jpg","original_language":"en","original_title":"Mission: Impossible - Fallout","genre_ids":[12,28,53],"backdrop_path":"\/5qxePyMYDisLe8rJiBYX8HKEyv2.jpg","adult":false,"overview":"When an IMF mission ends badly, the world is faced with dire consequences. As Ethan Hunt takes it upon himself to fulfil his original briefing, the CIA begin to question his loyalty and his motives. The IMF team find themselves in a race against time, hunted by assassins while trying to prevent a global catastrophe.","release_date":"2018-07-25"},{"vote_count":35,"id":439079,"video":false,"vote_average":6.3,"title":"The Nun","popularity":87.22,"poster_path":"\/sFC1ElvoKGdHJIWRpNB3xWJ9lJA.jpg","original_language":"en","original_title":"The Nun","genre_ids":[27,9648,53],"backdrop_path":"\/fgsHxz21B27hOOqQBiw9L6yWcM7.jpg","adult":false,"overview":"When a young nun at a cloistered abbey in Romania takes her own life, a priest with a haunted past and a novitiate on the threshold of her final vows are sent by the Vatican to investigate. Together they uncover the order’s unholy secret. Risking not only their lives but their faith and their very souls, they confront a malevolent force in the form of the same demonic nun that first terrorized audiences in “The Conjuring 2,” as the abbey becomes a horrific battleground between the living and the damned.","release_date":"2018-09-05"},{"vote_count":801,"id":493922,"video":false,"vote_average":7,"title":"Hereditary","popularity":84.801,"poster_path":"\/4GFPuL14eXi66V96xBWY73Y9PfR.jpg","original_language":"en","original_title":"Hereditary","genre_ids":[27,18,9648,53],"backdrop_path":"\/pS9Aub8MPyQbENblGD8mHeaqMuv.jpg","adult":false,"overview":"When Ellen, the matriarch of the Graham family, passes away, her daughter's family begins to unravel cryptic and increasingly terrifying secrets about their ancestry. The more they discover, the more they find themselves trying to outrun the sinister fate they seem to have inherited.","release_date":"2018-06-04"},{"vote_count":7905,"id":284054,"video":false,"vote_average":7.4,"title":"Black Panther","popularity":82.486,"poster_path":"\/uxzzxijgPIY7slzFvMotPv8wjKA.jpg","original_language":"en","original_title":"Black Panther","genre_ids":[28,12,14,878],"backdrop_path":"\/b6ZJZHUdMEFECvGiDpJjlfUWela.jpg","adult":false,"overview":"King T'Challa returns home from America to the reclusive, technologically advanced African nation of Wakanda to serve as his country's new leader. However, T'Challa soon finds that he is challenged for the throne by factions within his own country as well as without. Using powers reserved to Wakandan kings, T'Challa assumes the Black Panther mantel to join with girlfriend Nakia, the queen-mother, his princess-kid sister, members of the Dora Milaje (the Wakandan 'special forces') and an American secret agent, to prevent Wakanda from being dragged into a world war.","release_date":"2018-02-13"},{"vote_count":11,"id":390845,"video":false,"vote_average":3.9,"title":"A Delicious Flight","popularity":78.764,"poster_path":"\/kGlBKJBosHTA4elgHS54olzD4oS.jpg","original_language":"ko","original_title":"맛있는 비행","genre_ids":[10749],"backdrop_path":"\/4MJkbiDU5lr6TAwSLPV14C9w0vs.jpg","adult":false,"overview":"The in- flight service for Hong Kong starts now!  An erotic story that took place in the spacious blue sky!  An innocent actress runs away from the scandal with an idol, the impudent idol that ruined her career, a passionate manager who is devoted to her and his ex-girlfriend who is now a sexy stewardess. These four that should never be together run into each other in an airplane. No one can run away and the most cheeky and erotic things happen here.","release_date":"2015-11-01"},{"vote_count":127,"id":399360,"video":false,"vote_average":5.3,"title":"Alpha","popularity":78.716,"poster_path":"\/afdZAIcAQscziqVtsEoh2PwsYTW.jpg","original_language":"en","original_title":"Alpha","genre_ids":[12,18],"backdrop_path":"\/nKMeTdm72LQ756Eq20uTjF1zDXu.jpg","adult":false,"overview":"After a hunting expedition goes awry, a young caveman struggles against the elements to find his way home.","release_date":"2018-08-17"},{"vote_count":8149,"id":284053,"video":false,"vote_average":7.5,"title":"Thor: Ragnarok","popularity":63.103,"poster_path":"\/rzRwTcFvttcN1ZpX2xv4j3tSdJu.jpg","original_language":"en","original_title":"Thor: Ragnarok","genre_ids":[28,12],"backdrop_path":"\/kaIfm5ryEOwYg8mLbq8HkPuM1Fo.jpg","adult":false,"overview":"Thor is on the other side of the universe and finds himself in a race against time to get back to Asgard to stop Ragnarok, the prophecy of destruction to his homeworld and the end of Asgardian civilization, at the hands of an all-powerful new threat, the ruthless Hela.","release_date":"2017-10-25"},{"vote_count":18,"id":507569,"video":false,"vote_average":5.6,"title":"The Seven Deadly Sins: Prisoners of the Sky","popularity":61.395,"poster_path":"\/r6pPUVUKU5eIpYj4oEzidk5ZibB.jpg","original_language":"ja","original_title":"劇場版 七つの大罪 天空の囚われ人","genre_ids":[28,12,14,16],"backdrop_path":"\/uKwOX7MtKlAaGeCQe6c4jc1vZpj.jpg","adult":false,"overview":"The Seven Deadly Sins travel to a remote land in search of the phantom ingredient \"sky fish.\" Meliodas and Hawk end up at a \"Sky Palace\" that exists above the clouds, where all the residents have wings. Meliodas is mistaken for a boy who committed a crime and is thrown in prison. Meanwhile, the residents are preparing a ceremony for defense against a ferocious beast that awakens once every 3,000 years. But the Six Knights of Black, a Demon Clan army, arrives and removes the seal on the beast in order to threaten the lives of the residents of Sky Palace. Meliodas and his allies meet the Six Knights of Black in battle.","release_date":"2018-08-18"},{"vote_count":1920,"id":363088,"video":false,"vote_average":7,"title":"Ant-Man and the Wasp","popularity":59.613,"poster_path":"\/rv1AWImgx386ULjcf62VYaW8zSt.jpg","original_language":"en","original_title":"Ant-Man and the Wasp","genre_ids":[28,12,14,35,878],"backdrop_path":"\/6P3c80EOm7BodndGBUAJHHsHKrp.jpg","adult":false,"overview":"As Scott Lang awaits expiration of his term of house detention, Hope van Dyne and Dr. Hank Pym involve him in a scheme to rescue Mrs. van Dyne from the micro-universe into which she has fallen, while two groups of schemers converge on them with intentions of stealing Dr. Pym's inventions.","release_date":"2018-07-04"},{"vote_count":1513,"id":466282,"video":false,"vote_average":8.2,"title":"To All the Boys I've Loved Before","popularity":58.332,"poster_path":"\/hKHZhUbIyUAjcSrqJThFGYIR6kI.jpg","original_language":"en","original_title":"To All the Boys I've Loved Before","genre_ids":[35,10749],"backdrop_path":"\/hBHxBOGQBTMX3bDmqKoAgniZ9hE.jpg","adult":false,"overview":"Lara Jean's love life goes from imaginary to out of control when her secret letters to every boy she's ever fallen for are mysteriously mailed out.","release_date":"2018-08-17"},{"vote_count":14542,"id":118340,"video":false,"vote_average":7.9,"title":"Guardians of the Galaxy","popularity":55.162,"poster_path":"\/y31QB9kn3XSudA15tV7UWQ9XLuW.jpg","original_language":"en","original_title":"Guardians of the Galaxy","genre_ids":[28,878,12],"backdrop_path":"\/bHarw8xrmQeqf3t8HpuMY7zoK4x.jpg","adult":false,"overview":"Light years from Earth, 26 years after being abducted, Peter Quill finds himself the prime target of a manhunt after discovering an orb wanted by Ronan the Accuser.","release_date":"2014-07-30"},{"vote_count":16090,"id":24428,"video":false,"vote_average":7.6,"title":"The Avengers","popularity":54.777,"poster_path":"\/cezWGskPY5x7GaglTTRN4Fugfb8.jpg","original_language":"en","original_title":"The Avengers","genre_ids":[878,28,12],"backdrop_path":"\/hbn46fQaRmlpBuUrEiFqv0GDL6Y.jpg","adult":false,"overview":"When an unexpected enemy emerges and threatens global safety and security, Nick Fury, director of the international peacekeeping agency known as S.H.I.E.L.D., finds himself in need of a team to pull the world back from the brink of disaster. Spanning the globe, a daring recruitment effort begins!","release_date":"2012-04-25"},{"vote_count":575,"id":447200,"video":false,"vote_average":6,"title":"Skyscraper","popularity":51.901,"poster_path":"\/5LYSsOPzuP13201qSzMjNxi8FxN.jpg","original_language":"en","original_title":"Skyscraper","genre_ids":[28,53,18],"backdrop_path":"\/oMKFQmoVgB69fyXfSMu0lGlHJP2.jpg","adult":false,"overview":"Framed and on the run, a former FBI agent must save his family from a blazing fire in the world's tallest building.","release_date":"2018-07-11"},{"vote_count":6529,"id":181808,"video":false,"vote_average":7.1,"title":"Star Wars: The Last Jedi","popularity":51.317,"poster_path":"\/kOVEVeg59E0wsnXmF9nrh6OmWII.jpg","original_language":"en","original_title":"Star Wars: The Last Jedi","genre_ids":[14,12,878,28],"backdrop_path":"\/5Iw7zQTHVRBOYpA0V6z0yypOPZh.jpg","adult":false,"overview":"Rey develops her newly discovered abilities with the guidance of Luke Skywalker, who is unsettled by the strength of her powers. Meanwhile, the Resistance prepares to do battle with the First Order.","release_date":"2017-12-13"}]}
      const newMovies = response.results.map(({original_title, poster_path, overview, release_date, id, backdrop_path, vote_average}) => ({original_title, poster_path, overview, release_date, id, backdrop_path, vote_average}));
      this.setState({movies: newMovies, connected: true});
  }

  render() {
    return (
      <div className="App">
        <Layout>
            <PosterGrid movies={this.state.movies} />
        </Layout>
      </div>
    );
  }
}

export default App;
